/*!/*@nomin*/
module.exports=function(t){function e(e){for(var i,a,c=e[0],s=e[1],l=e[2],u=0,f=[];u<c.length;u++)a=c[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&f.push(r[a][0]),r[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i]);for(d&&d(e);f.length;)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(i=!1)}i&&(o.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},r={init:0},o=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=s;return o.push(["9908","chunk-vendors"]),n()}({"44e7":function(t,e,n){var i=n("861d"),r=n("c6b6"),o=n("b622")("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},"4d63":function(t,e,n){var i=n("83ab"),r=n("da84"),o=n("e330"),a=n("94ca"),c=n("7156"),s=n("9112"),l=n("9bf2").f,d=n("241c").f,u=n("3a9b"),f=n("44e7"),p=n("577e"),h=n("ad6d"),g=n("9f7f"),m=n("6eeb"),w=n("d039"),E=n("1a2d"),y=n("69f3").enforce,b=n("2626"),v=n("b622"),T=n("fce3"),k=n("107c"),_=v("match"),I=r.RegExp,O=I.prototype,D=r.SyntaxError,R=o(h),P=o(O.exec),x=o("".charAt),N=o("".replace),A=o("".indexOf),S=o("".slice),L=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,j=/a/g,X=/a/g,F=new I(j)!==j,B=g.MISSED_STICKY,C=g.UNSUPPORTED_Y,W=i&&(!F||B||T||k||w((function(){return X[_]=!1,I(j)!=j||I(X)==X||"/a/i"!=I(j,"i")})));if(a("RegExp",W)){for(var M=function(t,e){var n,i,r,o,a,l,d=u(O,this),h=f(t),g=void 0===e,m=[],w=t;if(!d&&h&&g&&t.constructor===M)return t;if((h||u(O,t))&&(t=t.source,g&&(e="flags"in w?w.flags:R(w))),t=void 0===t?"":p(t),e=void 0===e?"":p(e),w=t,T&&"dotAll"in j&&((i=!!e&&A(e,"s")>-1)&&(e=N(e,/s/g,""))),n=e,B&&"sticky"in j&&((r=!!e&&A(e,"y")>-1)&&C&&(e=N(e,/y/g,""))),k&&(t=(o=function(t){for(var e,n=t.length,i=0,r="",o=[],a={},c=!1,s=!1,l=0,d="";i<=n;i++){if("\\"===(e=x(t,i)))e+=x(t,++i);else if("]"===e)c=!1;else if(!c)switch(!0){case"["===e:c=!0;break;case"("===e:P(L,S(t,i+1))&&(i+=2,s=!0),r+=e,l++;continue;case">"===e&&s:if(""===d||E(a,d))throw new D("Invalid capture group name");a[d]=!0,o[o.length]=[d,l],s=!1,d="";continue}s?d+=e:r+=e}return[r,o]}(t))[0],m=o[1]),a=c(I(t,e),d?this:O,M),(i||r||m.length)&&(l=y(a),i&&(l.dotAll=!0,l.raw=M(function(t){for(var e,n=t.length,i=0,r="",o=!1;i<=n;i++)"\\"!==(e=x(t,i))?o||"."!==e?("["===e?o=!0:"]"===e&&(o=!1),r+=e):r+="[\\s\\S]":r+=e+x(t,++i);return r}(t),n)),r&&(l.sticky=!0),m.length&&(l.groups=m)),t!==w)try{s(a,"source",""===w?"(?:)":w)}catch(t){}return a},Y=function(t){t in M||l(M,t,{configurable:!0,get:function(){return I[t]},set:function(e){I[t]=e}})},G=d(I),$=0;G.length>$;)Y(G[$++]);O.constructor=M,M.prototype=O,m(r,"RegExp",M)}b("RegExp")},5700:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r}));var i,r,o=n("5530");(function(t){t.saved="saved",t.cancel="cancel",t.reload="reload"})(i||(i={})),function(t){t.relaunch="relaunch"}(r||(r={})),e.b=Object(o.a)(Object(o.a)({},i),r)},7156:function(t,e,n){var i=n("1626"),r=n("861d"),o=n("d2bb");t.exports=function(t,e,n){var a,c;return o&&i(a=e.constructor)&&a!==n&&r(c=a.prototype)&&c!==n.prototype&&o(t,c),t}},9908:function(t,e,n){"use strict";n.r(e),n("e6cf"),n("a79d");var i,r=n("1da1"),o=n("5530");n("4d63"),n("ac1f"),n("07ac"),function(t){t.SINGLE_BEST_VALUE="single-best-value"}(i||(i={}));var a=i;class c{constructor(t){this.ENTITY_ID_REGEX_INDEX=2,this.PROPERTY_ID_REGEX_INDEX=3,this.ENTITY_TITLE_REGEX_INDEX=1,this.hrefRegExp=new RegExp(t)}extractDataFromLink(t){const e=t.href.match(this.hrefRegExp);return e&&e[this.ENTITY_ID_REGEX_INDEX]&&e[this.PROPERTY_ID_REGEX_INDEX]&&e[this.ENTITY_TITLE_REGEX_INDEX]?{entityId:e[this.ENTITY_ID_REGEX_INDEX],propertyId:e[this.PROPERTY_ID_REGEX_INDEX],entityTitle:e[this.ENTITY_TITLE_REGEX_INDEX]}:null}validateEditFlow(t){return t&&Object.values(a).includes(t)?t:null}getEditFlowFromParent(t){return 1!==t.querySelectorAll("a").length?null:this.validateEditFlow(t.dataset.bridgeEditFlow)}extractDataFromElement(t){const e=this.getEditFlowFromParent(t.parentElement);if(!e)return null;const n=this.extractDataFromLink(t);return null===n?null:Object(o.a)(Object(o.a)({},n),{},{link:t,editFlow:e})}selectElementsToOverload(){return Array.from(document.querySelectorAll("[data-bridge-edit-flow] > a")).map(t=>this.extractDataFromElement(t)).filter(t=>null!==t)}}var s=n("5700");class l{constructor(t,e,n,i){this.mwWindow=t,this.app=e,this.dataBridgeConfig=n,this.eventTracker=i}dispatch(t){const e=function(t,e,n){const i=function(t){i.parent.call(this,t)};t.inheritClass(i,t.ui.Dialog),i.static.name="data-bridge",i.static.escapable=!1,i.prototype.initialize=function(){i.parent.prototype.initialize.call(this),this.content=new t.ui.PanelLayout({padded:!1,expanded:!1}),this.content.$element.attr("id",n),this.$body.append(this.content.$element)},i.prototype.getBodyHeight=function(){return 448};const r=new i({classes:["wb-db-dialog"],size:"medium"}),o=new t.ui.WindowManager;return e(document.body).append(o.$element),o.addWindows([r]),o.openWindow(r),r}(this.mwWindow.OO,this.mwWindow.$,l.APP_DOM_CONTAINER_ID);!function(t,e,n){t.on(s.c.saved,()=>{n.location.reload()}),t.on(s.c.cancel,()=>{e.clearWindows().catch(()=>{})}),t.on(s.c.reload,()=>{n.location.reload()}),e.on("closing",(t,n)=>{n.then(()=>{e.destroy()},t=>{e.destroy()})})}(this.app.launch({containerSelector:"#"+l.APP_DOM_CONTAINER_ID},{pageTitle:this.mwWindow.mw.config.get("wgPageName"),entityId:t.entityId,propertyId:t.propertyId,entityTitle:t.entityTitle,editFlow:t.editFlow,client:{usePublish:this.dataBridgeConfig.usePublish,issueReportingLink:this.dataBridgeConfig.issueReportingLink},originalHref:t.link.href,pageUrl:this.mwWindow.location.href,userName:this.mwWindow.mw.config.get("wgUserName")},this.app.createServices(this.mwWindow,this.dataBridgeConfig.editTags,this.eventTracker)),e.getManager(),this.mwWindow)}}l.APP_DOM_CONTAINER_ID="data-bridge-container";class d{constructor(t){this.tracker=t}increment(t){this.tracker("counter."+t,1)}recordTiming(t,e){this.tracker("timing."+t,e)}}class u{constructor(t,e,n){this.tracker=t,this.performance=e,this.visibilityApi=n}startClickDelayTracker(){const t=this.performance.now();return()=>{const e=this.performance.now()-t;this.tracker.recordTiming("clickDelay",e)}}recordTimeToLinkListenersAttached(){if(this.isTabInBackground())return;const t=this.performance.now();if(!this.performance.getEntriesByName||0===this.performance.getEntriesByName("mwStartup").length)return;const e=this.performance.getEntriesByName("mwStartup")[0];this.tracker.recordTiming("timeToLinkListenersAttached",t-e.startTime)}isTabInBackground(){return this.visibilityApi.hidden||this.visibilityApi.msHidden||this.visibilityApi.webkitHidden}}class f{constructor(t,e){this.tracker=t,this.trackingTopicPrefix=e}increment(t){this.tracker.increment(`${this.trackingTopicPrefix}.${t}`)}recordTiming(t,e){this.tracker.recordTiming(`${this.trackingTopicPrefix}.${t}`,e)}}const p="wikibase.client.data-bridge.app";var h=Object(r.a)((function*(){const t=window,e=t.mw.config.get("wbDataBridgeConfig");if(null===e.hrefRegExp)return void t.mw.log.warn("data bridge config incomplete: dataBridgeHrefRegExp missing");const n=new c(e.hrefRegExp).selectElementsToOverload();if(n.length>0){const i=new f(new d(t.mw.track),"MediaWiki.wikibase.client.databridge"),o=t.mw.loader.using([p,"mw.config.values.wbRepo","mediawiki.ForeignApi","mediawiki.api","jquery.uls.data","mediawiki.language"]).then(function(){var n=Object(r.a)((function*(n){const r=yield n(p);return new l(t,r,e,i)}));return function(t){return n.apply(this,arguments)}}()),a=new u(i,window.performance,window.document);n.forEach(t=>{let e=!1;t.link.setAttribute("aria-haspopup","dialog"),t.link.addEventListener("click",function(){var n=Object(r.a)((function*(n){if(n.altKey||n.ctrlKey||n.shiftKey||n.metaKey)return;if(function(t){t.preventDefault(),t.stopPropagation()}(n),e)return;e=!0;const i=a.startClickDelayTracker();(yield o).dispatch(t),i(),e=!1}));return function(t){return n.apply(this,arguments)}}())}),a.recordTimeToLinkListenersAttached(),yield o}}));"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h()}});